# ============================================================================
# MERCADOLIBRE INTEGRATION SERVICE ENVIRONMENT VARIABLES
# ============================================================================
# MercadoLibre marketplace integration configuration
# ============================================================================

# ----------------------------------------------------------------------------
# SERVICE CONFIGURATION
# ----------------------------------------------------------------------------

SERVICE_NAME=mercadolibre-integration
SERVICE_PORT=8022
SERVICE_HOST=0.0.0.0
ENVIRONMENT=development

# ----------------------------------------------------------------------------
# MERCADOLIBRE API CONFIGURATION
# ----------------------------------------------------------------------------

# Application credentials
MELI_APP_ID=your-app-id
MELI_CLIENT_SECRET=your-client-secret
MELI_REDIRECT_URI=https://api.quenty.com/meli/callback
MELI_SITE_ID=MCO  # MCO for Colombia, MLM for Mexico, etc.

# OAuth tokens (will be refreshed automatically)
MELI_ACCESS_TOKEN=
MELI_REFRESH_TOKEN=
MELI_USER_ID=

# API settings
MELI_API_URL=https://api.mercadolibre.com
MELI_AUTH_URL=https://auth.mercadolibre.com.co/authorization
MELI_API_VERSION=v1
MELI_API_TIMEOUT=30

# Rate limiting
MELI_RATE_LIMIT=10000  # per hour
MELI_CONCURRENT_REQUESTS=10

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------

DATABASE_URL=postgresql://postgres:password@meli-db:5432/mercadolibre_db
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION
# ----------------------------------------------------------------------------

REDIS_URL=redis://:password@redis:6379/12
REDIS_TOKEN_KEY=meli:tokens
REDIS_CACHE_PREFIX=meli:cache:
REDIS_CACHE_TTL=3600

# ----------------------------------------------------------------------------
# OAUTH2 CONFIGURATION
# ----------------------------------------------------------------------------

# Token management
AUTO_REFRESH_TOKEN=true
TOKEN_REFRESH_BUFFER=300  # Refresh 5 minutes before expiry
TOKEN_STORAGE=redis  # redis, database, file

# Authorization
REQUIRED_SCOPES=read,write,offline_access
AUTHORIZATION_TIMEOUT=300  # 5 minutes

# ----------------------------------------------------------------------------
# NOTIFICATION CONFIGURATION
# ----------------------------------------------------------------------------

# Notifications API
NOTIFICATIONS_ENABLED=true
NOTIFICATIONS_PORT=8023
NOTIFICATIONS_PATH=/meli/notifications
NOTIFICATIONS_SECRET=your-notification-secret

# Topics to subscribe
TOPIC_ORDERS=true
TOPIC_ITEMS=true
TOPIC_QUESTIONS=true
TOPIC_MESSAGES=true
TOPIC_PAYMENTS=true
TOPIC_SHIPMENTS=true
TOPIC_CLAIMS=true
TOPIC_INVOICES=false

# ----------------------------------------------------------------------------
# SYNC CONFIGURATION
# ----------------------------------------------------------------------------

# Sync settings
SYNC_ENABLED=true
SYNC_INTERVAL=300  # 5 minutes
SYNC_BATCH_SIZE=50
SYNC_WORKERS=4

# Entity sync
SYNC_PRODUCTS=true
SYNC_ORDERS=true
SYNC_QUESTIONS=true
SYNC_MESSAGES=true
SYNC_REPUTATION=true
SYNC_SHIPMENTS=true
SYNC_FEEDBACK=true

# Sync direction
PUBLISH_TO_MELI=true
IMPORT_FROM_MELI=true
TWO_WAY_SYNC=true

# ----------------------------------------------------------------------------
# PRODUCT LISTING
# ----------------------------------------------------------------------------

# Listing configuration
AUTO_PUBLISH=false
LISTING_TYPE=gold_special  # free, bronze, silver, gold, gold_special, gold_pro
LISTING_STATUS=active  # active, paused
AUTOMATIC_RENEWAL=true

# Product mapping
MAP_CATEGORIES=true
USE_MELI_ATTRIBUTES=true
SYNC_VARIATIONS=true
SYNC_PICTURES=true
MAX_PICTURES_PER_ITEM=10

# Pricing
PRICING_STRATEGY=fixed  # fixed, markup, competitive
PRICE_MARKUP_PERCENTAGE=10
INCLUDE_SHIPPING_IN_PRICE=false
CURRENCY=COP

# Stock
AVAILABLE_QUANTITY_SYNC=true
STOCK_BUFFER=2  # Keep 2 units as buffer
OUT_OF_STOCK_PAUSE=true

# ----------------------------------------------------------------------------
# ORDER MANAGEMENT
# ----------------------------------------------------------------------------

# Order processing
AUTO_ACCEPT_ORDERS=true
ORDER_CONFIRMATION_DELAY=60  # seconds
CREATE_INTERNAL_ORDERS=true

# Order status mapping
MAP_ORDER_STATUS=true
STATUS_CONFIRMED=confirmed
STATUS_PAYMENT_REQUIRED=payment_required
STATUS_PAYMENT_IN_PROCESS=payment_in_process
STATUS_PAID=paid
STATUS_CANCELLED=cancelled

# Shipping
SHIPPING_MODE=me2  # custom, me1, me2
FREE_SHIPPING_ENABLED=false
FREE_SHIPPING_THRESHOLD=100000  # COP

# Fulfillment
FULFILLMENT_TYPE=fulfillment  # fulfillment, self_service, xd, drop_off
HANDLING_TIME=2  # business days

# ----------------------------------------------------------------------------
# MERCADOPAGO INTEGRATION
# ----------------------------------------------------------------------------

# Payment processing
MERCADOPAGO_ENABLED=true
MERCADOPAGO_PUBLIC_KEY=your-public-key
MERCADOPAGO_ACCESS_TOKEN=your-access-token

# Payment settings
ACCEPT_MERCADOPAGO=true
ACCEPT_OTHER_PAYMENTS=false
INSTALLMENTS_ENABLED=true
MAX_INSTALLMENTS=12

# ----------------------------------------------------------------------------
# MERCADOENVIOS (SHIPPING)
# ----------------------------------------------------------------------------

# Shipping integration
MERCADOENVIOS_ENABLED=true
SHIPPING_METHODS=mercadoenvios_express,mercadoenvios_standard
DEFAULT_SHIPPING_METHOD=mercadoenvios_standard

# Shipping preferences
PICKUP_ENABLED=false
LOCAL_PICKUP_ENABLED=false
SHIPPING_DIMENSIONS_REQUIRED=true

# Shipping costs
FREE_SHIPPING_METHOD=none  # none, standard, express
ABSORB_SHIPPING_COST=false

# ----------------------------------------------------------------------------
# QUESTIONS & ANSWERS
# ----------------------------------------------------------------------------

# Q&A management
AUTO_ANSWER_ENABLED=false
AUTO_ANSWER_TEMPLATES=true
ANSWER_TIME_LIMIT=24  # hours
BLACKLIST_ENABLED=true

# Common answers
FAQ_ENABLED=true
FAQ_AUTO_RESPONSE=false

# ----------------------------------------------------------------------------
# MESSAGING
# ----------------------------------------------------------------------------

# Message center
MESSAGING_ENABLED=true
AUTO_RESPONSE_ENABLED=false
MESSAGE_TEMPLATES_ENABLED=true
MAX_MESSAGE_LENGTH=2000

# Attachments
ALLOW_ATTACHMENTS=true
MAX_ATTACHMENT_SIZE=10485760  # 10MB

# ----------------------------------------------------------------------------
# REPUTATION & METRICS
# ----------------------------------------------------------------------------

# Reputation monitoring
MONITOR_REPUTATION=true
REPUTATION_ALERT_THRESHOLD=yellow  # red, yellow, green
REPUTATION_CHECK_INTERVAL=3600  # 1 hour

# Metrics tracking
TRACK_SALES_METRICS=true
TRACK_CLAIMS=true
TRACK_CANCELLATIONS=true
TRACK_DELAYED_SHIPMENTS=true

# ----------------------------------------------------------------------------
# CATEGORY MAPPING
# ----------------------------------------------------------------------------

# Category configuration
AUTO_CATEGORY_MAPPING=true
CATEGORY_PREDICTION_API=true
DEFAULT_CATEGORY_ID=MCO1227  # Default category if mapping fails

# Attributes
REQUIRED_ATTRIBUTES_ONLY=false
MAP_CUSTOM_ATTRIBUTES=true

# ----------------------------------------------------------------------------
# ADVERTISING
# ----------------------------------------------------------------------------

# Product Ads
PRODUCT_ADS_ENABLED=false
ADS_BUDGET_DAILY=50000  # COP
ADS_CAMPAIGN_TYPE=product_ads

# Promotions
PROMOTIONS_ENABLED=true
DISCOUNT_CAMPAIGNS=true
FLASH_DEALS=false

# ----------------------------------------------------------------------------
# COMPLIANCE
# ----------------------------------------------------------------------------

# Invoice generation
INVOICE_GENERATION=true
ELECTRONIC_INVOICE=true
INVOICE_PREFIX=MELI

# Tax settings
INCLUDE_TAXES=true
TAX_RATE=0.19  # 19% IVA
TAX_ID=your-tax-id

# Legal
TERMS_CONDITIONS_URL=https://quenty.com/terms
RETURN_POLICY_URL=https://quenty.com/returns
WARRANTY_TERMS=standard

# ----------------------------------------------------------------------------
# ERROR HANDLING
# ----------------------------------------------------------------------------

# Retry configuration
MAX_RETRY_ATTEMPTS=5
RETRY_DELAY=2000  # ms
EXPONENTIAL_BACKOFF=true
RETRY_ON_RATE_LIMIT=true

# Error recovery
AUTO_RECOVER_LISTINGS=true
PAUSE_ON_CRITICAL_ERROR=true

# ----------------------------------------------------------------------------
# MONITORING
# ----------------------------------------------------------------------------

METRICS_ENABLED=true
METRICS_PORT=9096
HEALTH_CHECK_PATH=/health
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/logs/mercadolibre-integration.log

# Alerts
ALERT_ON_TOKEN_REFRESH_FAIL=true
ALERT_ON_LOW_REPUTATION=true
ALERT_ON_SYNC_FAILURE=true
ALERT_EMAIL=admin@quenty.com

# ----------------------------------------------------------------------------
# CACHING
# ----------------------------------------------------------------------------

CACHE_ENABLED=true
CACHE_CATEGORIES=true
CACHE_USER_INFO=true
CACHE_SHIPPING_METHODS=true
CACHE_TTL=86400  # 24 hours for static data

# ----------------------------------------------------------------------------
# DEVELOPMENT
# ----------------------------------------------------------------------------

DEBUG_MODE=false
SANDBOX_MODE=false
TEST_USER_ENABLED=false
MOCK_NOTIFICATIONS=false
LOG_API_CALLS=false