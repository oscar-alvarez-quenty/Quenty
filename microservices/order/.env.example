# ============================================================================
# ORDER SERVICE ENVIRONMENT VARIABLES
# ============================================================================
# Order management and processing microservice configuration
# ============================================================================

# ----------------------------------------------------------------------------
# SERVICE CONFIGURATION
# ----------------------------------------------------------------------------

SERVICE_NAME=order-service
SERVICE_PORT=8003
SERVICE_HOST=0.0.0.0
ENVIRONMENT=development

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------

DATABASE_URL=postgresql://postgres:password@order-db:5432/order_db
DATABASE_POOL_SIZE=15
DATABASE_MAX_OVERFLOW=30
DATABASE_ECHO=false

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION
# ----------------------------------------------------------------------------

REDIS_URL=redis://:password@redis:6379/4
REDIS_ORDER_PREFIX=order:
REDIS_CART_PREFIX=cart:
REDIS_CART_TTL=7200  # 2 hours

# ----------------------------------------------------------------------------
# ORDER SETTINGS
# ----------------------------------------------------------------------------

# Order configuration
ORDER_PREFIX=QTY  # Prefix for order numbers
ORDER_NUMBER_LENGTH=10
ORDER_NUMBER_SEQUENTIAL=true
ALLOW_GUEST_CHECKOUT=true
REQUIRE_SHIPPING_ADDRESS=true
REQUIRE_BILLING_ADDRESS=false

# Order statuses
ORDER_STATUS_PENDING=pending
ORDER_STATUS_CONFIRMED=confirmed
ORDER_STATUS_PROCESSING=processing
ORDER_STATUS_SHIPPED=shipped
ORDER_STATUS_DELIVERED=delivered
ORDER_STATUS_CANCELLED=cancelled
ORDER_STATUS_REFUNDED=refunded

# Order limits
MIN_ORDER_AMOUNT=10000  # COP
MAX_ORDER_AMOUNT=100000000  # COP
MAX_ITEMS_PER_ORDER=100
MAX_QUANTITY_PER_ITEM=999

# ----------------------------------------------------------------------------
# INVENTORY MANAGEMENT
# ----------------------------------------------------------------------------

INVENTORY_CHECK_ENABLED=true
INVENTORY_SERVICE_URL=http://inventory-service:8015/api/v1
INVENTORY_RESERVE_ON_CHECKOUT=true
INVENTORY_RELEASE_ON_CANCEL=true
INVENTORY_LOW_STOCK_THRESHOLD=10
INVENTORY_OUT_OF_STOCK_NOTIFICATION=true

# ----------------------------------------------------------------------------
# PRICING CONFIGURATION
# ----------------------------------------------------------------------------

# Tax settings
TAX_ENABLED=true
DEFAULT_TAX_RATE=0.19  # 19% IVA
TAX_INCLUDED_IN_PRICE=false
TAX_CALCULATION_SERVICE=internal  # internal, external

# Discounts
ALLOW_MULTIPLE_COUPONS=false
COUPON_VALIDATION_SERVICE=http://promotion-service:8016/validate
MAX_DISCOUNT_PERCENTAGE=50
ALLOW_NEGATIVE_PRICES=false

# Currency
DEFAULT_CURRENCY=COP
SUPPORTED_CURRENCIES=COP,USD,EUR
CURRENCY_EXCHANGE_SERVICE=http://exchange-service:8017/rates

# ----------------------------------------------------------------------------
# PAYMENT INTEGRATION
# ----------------------------------------------------------------------------

PAYMENT_SERVICE_URL=http://payment-service:8018/api/v1
PAYMENT_TIMEOUT=30
PAYMENT_AUTO_CAPTURE=false
PAYMENT_RETRY_ATTEMPTS=3
ALLOWED_PAYMENT_METHODS=credit_card,debit_card,pse,cash,bank_transfer

# Payment providers
STRIPE_ENABLED=true
PAYU_ENABLED=true
WOMPI_ENABLED=true
MERCADOPAGO_ENABLED=false

# ----------------------------------------------------------------------------
# SHIPPING CONFIGURATION
# ----------------------------------------------------------------------------

SHIPPING_SERVICE_URL=http://shipping-service:8019/api/v1
SHIPPING_CALCULATION=realtime  # realtime, flat_rate, table_based
DEFAULT_SHIPPING_PROVIDER=servientrega
SHIPPING_FREE_THRESHOLD=100000  # COP
ESTIMATE_DELIVERY_TIME=true

# Shipping zones
SHIPPING_ZONES=local,national,international
LOCAL_SHIPPING_RATE=8000
NATIONAL_SHIPPING_RATE=15000
INTERNATIONAL_SHIPPING_RATE=50000

# ----------------------------------------------------------------------------
# FULFILLMENT SETTINGS
# ----------------------------------------------------------------------------

# Fulfillment types
FULFILLMENT_TYPES=standard,express,same_day,pickup
DEFAULT_FULFILLMENT_TYPE=standard

# Processing times (hours)
STANDARD_PROCESSING_TIME=48
EXPRESS_PROCESSING_TIME=24
SAME_DAY_PROCESSING_TIME=4

# Warehouse management
MULTI_WAREHOUSE_ENABLED=false
DEFAULT_WAREHOUSE_ID=main
WAREHOUSE_AUTO_SELECT=true

# ----------------------------------------------------------------------------
# NOTIFICATION SETTINGS
# ----------------------------------------------------------------------------

# Order notifications
NOTIFY_ORDER_PLACED=true
NOTIFY_ORDER_CONFIRMED=true
NOTIFY_ORDER_SHIPPED=true
NOTIFY_ORDER_DELIVERED=true
NOTIFY_ORDER_CANCELLED=true

# Notification channels
EMAIL_NOTIFICATIONS=true
SMS_NOTIFICATIONS=true
PUSH_NOTIFICATIONS=false
WHATSAPP_NOTIFICATIONS=false

# ----------------------------------------------------------------------------
# WORKFLOW AUTOMATION
# ----------------------------------------------------------------------------

# Auto-confirmation
AUTO_CONFIRM_ORDERS=false
AUTO_CONFIRM_DELAY=300  # 5 minutes
AUTO_CONFIRM_PAYMENT_REQUIRED=true

# Auto-cancellation
AUTO_CANCEL_UNPAID_ORDERS=true
AUTO_CANCEL_TIMEOUT=86400  # 24 hours
AUTO_CANCEL_NOTIFY_CUSTOMER=true

# Order routing
ORDER_ROUTING_ENABLED=false
ORDER_ROUTING_RULES=proximity,availability,capacity

# ----------------------------------------------------------------------------
# REPORTING
# ----------------------------------------------------------------------------

# Report generation
DAILY_REPORTS_ENABLED=true
WEEKLY_REPORTS_ENABLED=true
MONTHLY_REPORTS_ENABLED=true
REPORT_GENERATION_TIME=02:00
REPORT_STORAGE_PATH=/reports
REPORT_RETENTION_DAYS=365

# Analytics
TRACK_CONVERSION_FUNNEL=true
TRACK_ABANDONED_CARTS=true
ABANDONED_CART_THRESHOLD=3600  # 1 hour

# ----------------------------------------------------------------------------
# RETURN MANAGEMENT
# ----------------------------------------------------------------------------

RETURNS_ENABLED=true
RETURN_WINDOW_DAYS=30
RETURN_REASONS_REQUIRED=true
RETURN_PHOTO_REQUIRED=false
AUTO_APPROVE_RETURNS=false
REFUND_PROCESSING_TIME=72  # hours

# ----------------------------------------------------------------------------
# FRAUD DETECTION
# ----------------------------------------------------------------------------

FRAUD_DETECTION_ENABLED=true
FRAUD_SERVICE_URL=http://fraud-service:8020/check
FRAUD_SCORE_THRESHOLD=70
HIGH_RISK_MANUAL_REVIEW=true
BLOCK_HIGH_RISK_ORDERS=false

# Risk indicators
CHECK_BILLING_SHIPPING_MATCH=true
CHECK_EMAIL_DOMAIN=true
CHECK_IP_LOCATION=true
CHECK_VELOCITY=true
MAX_ORDERS_PER_DAY=10

# ----------------------------------------------------------------------------
# EXTERNAL INTEGRATIONS
# ----------------------------------------------------------------------------

# ERP Integration
ERP_INTEGRATION_ENABLED=false
ERP_SYSTEM=sap  # sap, oracle, microsoft
ERP_SYNC_INTERVAL=3600
ERP_API_URL=https://erp.example.com/api
ERP_API_KEY=your-erp-api-key

# Marketplace sync
SYNC_TO_MARKETPLACE=false
MARKETPLACE_PLATFORMS=mercadolibre,amazon,shopify

# ----------------------------------------------------------------------------
# PERFORMANCE SETTINGS
# ----------------------------------------------------------------------------

# Caching
CACHE_ORDER_DATA=true
CACHE_CUSTOMER_ORDERS=true
CACHE_PRODUCT_INFO=false
CACHE_TTL=3600

# Pagination
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# Async processing
ASYNC_ORDER_PROCESSING=true
WORKER_POOL_SIZE=10
TASK_QUEUE=celery

# ----------------------------------------------------------------------------
# MONITORING
# ----------------------------------------------------------------------------

METRICS_ENABLED=true
METRICS_PORT=9093
HEALTH_CHECK_PATH=/health
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/logs/order-service.log

# Alerts
ALERT_ON_FAILED_ORDERS=true
ALERT_ON_HIGH_CANCELLATION=true
ALERT_THRESHOLD_CANCELLATION=10  # percentage

# ----------------------------------------------------------------------------
# BACKUP AND RECOVERY
# ----------------------------------------------------------------------------

BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 3 * * *"  # Daily at 3 AM
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE=s3  # local, s3, gcs
BACKUP_S3_BUCKET=quenty-order-backups