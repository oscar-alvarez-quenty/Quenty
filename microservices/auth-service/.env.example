# ============================================================================
# AUTH SERVICE ENVIRONMENT VARIABLES
# ============================================================================
# Authentication and authorization microservice configuration
# ============================================================================

# ----------------------------------------------------------------------------
# SERVICE CONFIGURATION
# ----------------------------------------------------------------------------

SERVICE_NAME=auth-service
SERVICE_PORT=8001
SERVICE_HOST=0.0.0.0
ENVIRONMENT=development  # development, staging, production

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------

# Primary database for user accounts
DATABASE_URL=postgresql://postgres:password@auth-db:5432/auth_db
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_ECHO=false  # Set to true for SQL query logging

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION
# ----------------------------------------------------------------------------

# Redis for session management and caching
REDIS_URL=redis://:password@redis:6379/2
REDIS_SESSION_TTL=86400  # 24 hours in seconds
REDIS_BLACKLIST_TTL=604800  # 7 days for token blacklist

# ----------------------------------------------------------------------------
# JWT CONFIGURATION
# ----------------------------------------------------------------------------

# JWT Secret (generate with: openssl rand -hex 64)
JWT_SECRET_KEY=your-super-secret-jwt-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
JWT_EMAIL_VERIFICATION_EXPIRE_HOURS=48
JWT_PASSWORD_RESET_EXPIRE_HOURS=24

# ----------------------------------------------------------------------------
# OAUTH2 CONFIGURATION
# ----------------------------------------------------------------------------

# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8001/auth/google/callback

# Facebook OAuth
FACEBOOK_APP_ID=your-facebook-app-id
FACEBOOK_APP_SECRET=your-facebook-app-secret
FACEBOOK_REDIRECT_URI=http://localhost:8001/auth/facebook/callback

# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_REDIRECT_URI=http://localhost:8001/auth/github/callback

# ----------------------------------------------------------------------------
# TWO-FACTOR AUTHENTICATION
# ----------------------------------------------------------------------------

# TOTP Settings
TOTP_ISSUER=Quenty Platform
TOTP_ALGORITHM=SHA1
TOTP_DIGITS=6
TOTP_INTERVAL=30

# SMS Provider for 2FA (Twilio)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_FROM_NUMBER=+1234567890
SMS_2FA_CODE_LENGTH=6
SMS_2FA_CODE_EXPIRY=300  # 5 minutes

# ----------------------------------------------------------------------------
# EMAIL CONFIGURATION
# ----------------------------------------------------------------------------

# SMTP Settings for email verification
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
SMTP_FROM_EMAIL=noreply@quenty.com
SMTP_USE_TLS=true

# Email templates
EMAIL_VERIFICATION_TEMPLATE=verify_email.html
PASSWORD_RESET_TEMPLATE=reset_password.html
WELCOME_EMAIL_TEMPLATE=welcome.html

# ----------------------------------------------------------------------------
# PASSWORD POLICY
# ----------------------------------------------------------------------------

# Password requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_SPECIAL_CHARS=!@#$%^&*()_+-=[]{}|;:,.<>?

# Password hashing
BCRYPT_ROUNDS=12
PASSWORD_HISTORY_COUNT=5  # Number of previous passwords to check

# ----------------------------------------------------------------------------
# SECURITY SETTINGS
# ----------------------------------------------------------------------------

# Rate limiting
LOGIN_RATE_LIMIT=5/minute
REGISTER_RATE_LIMIT=3/hour
PASSWORD_RESET_RATE_LIMIT=3/hour
API_RATE_LIMIT=100/minute

# Session security
SESSION_COOKIE_SECURE=false  # Set to true in production with HTTPS
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax
SESSION_IDLE_TIMEOUT=1800  # 30 minutes

# Account security
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=1800  # 30 minutes
REQUIRE_EMAIL_VERIFICATION=true
ALLOW_MULTIPLE_SESSIONS=true
MAX_CONCURRENT_SESSIONS=5

# ----------------------------------------------------------------------------
# CAPTCHA CONFIGURATION
# ----------------------------------------------------------------------------

# reCAPTCHA v2/v3
RECAPTCHA_ENABLED=true
RECAPTCHA_SITE_KEY=your-recaptcha-site-key
RECAPTCHA_SECRET_KEY=your-recaptcha-secret-key
RECAPTCHA_THRESHOLD=0.5  # For v3

# ----------------------------------------------------------------------------
# AUDIT LOGGING
# ----------------------------------------------------------------------------

AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_FILE=/logs/audit.log
AUDIT_LOG_MAX_SIZE=10485760  # 10MB
AUDIT_LOG_BACKUP_COUNT=10

# Events to audit
AUDIT_LOGIN_SUCCESS=true
AUDIT_LOGIN_FAILURE=true
AUDIT_LOGOUT=true
AUDIT_PASSWORD_CHANGE=true
AUDIT_PROFILE_UPDATE=true
AUDIT_PERMISSION_CHANGE=true

# ----------------------------------------------------------------------------
# LDAP/ACTIVE DIRECTORY (Optional)
# ----------------------------------------------------------------------------

LDAP_ENABLED=false
LDAP_SERVER=ldap://ldap.example.com
LDAP_PORT=389
LDAP_USE_TLS=false
LDAP_BIND_DN=cn=admin,dc=example,dc=com
LDAP_BIND_PASSWORD=admin_password
LDAP_BASE_DN=ou=users,dc=example,dc=com
LDAP_USER_FILTER=(uid={username})

# ----------------------------------------------------------------------------
# MONITORING
# ----------------------------------------------------------------------------

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9091

# Health check
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INCLUDE_DB=true
HEALTH_CHECK_INCLUDE_REDIS=true

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/logs/auth-service.log

# ----------------------------------------------------------------------------
# CORS SETTINGS
# ----------------------------------------------------------------------------

CORS_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# ----------------------------------------------------------------------------
# FEATURE FLAGS
# ----------------------------------------------------------------------------

FEATURE_SOCIAL_LOGIN=true
FEATURE_TWO_FACTOR_AUTH=true
FEATURE_BIOMETRIC_AUTH=false
FEATURE_PASSWORDLESS_LOGIN=false
FEATURE_MAGIC_LINKS=false
FEATURE_SSO=false

# ----------------------------------------------------------------------------
# SERVICE DISCOVERY
# ----------------------------------------------------------------------------

SERVICE_DISCOVERY_ENABLED=false
CONSUL_HOST=consul
CONSUL_PORT=8500
SERVICE_HEALTH_CHECK_INTERVAL=10s
SERVICE_DEREGISTER_CRITICAL_AFTER=1m